---
import Layout from "../layouts/Layout.astro";
import ProjectNav from "../components/ProjectNav.astro";
import ProjectView from "../components/ProjectView.tsx";
import Footer from "../components/Footer.astro";
import { getCollection } from "astro:content";
import Logo from "../components/Logo.astro";

const projects = await getCollection("projects");
---

<Layout title="Isovist">
  <main
    class="p-4 h-screen w-screen grid grid-cols-1 gap-4 grid-rows-[1fr_6fr_1fr_20px] z-10"
  >
    <ProjectView projects={projects} client:load>
      <Logo slot="logo" />
    </ProjectView>
    <ProjectNav projects={projects} />
    <Footer />
  </main>
</Layout>

<script>
  window.currentProjectIndex = 0;

  window.changeProject = (index) => {
    window.currentProjectIndex = index;
    window.dispatchEvent(new CustomEvent("projectChanged"));
  };
</script>
